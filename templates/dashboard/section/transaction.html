{%extends "../home.html"%} {%block content%}
<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  .container {
    max-width: 800px;
    margin: 0 auto;
    padding: 24px;
  }

   .welcome-section {
    margin-bottom: 2rem;
  }

  .welcome-section h2 {
    font-size: 1.5rem;
    font-weight: bold;
    color: #111827;
    margin-bottom: 0.5rem;
  }

  .welcome-section p {
    color: #6b7280;
  }

  .tabs {
    display: flex;
    background: white;
    border-radius: 8px;
    padding: 4px;
    margin-bottom: 24px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  }

  .tab {
    flex: 1;
    padding: 12px 16px;
    text-align: center;
    background: none;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.2s;
  }

  .tab.active {
    background-color: #2563eb;
    color: white;
  }

  .tab:not(.active) {
    color: #6b7280;
  }

  .tab:not(.active):hover {
    background-color: #f3f4f6;
  }

  .card {
    background: white;
    border-radius: 8px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    border: 1px solid #e5e7eb;
    padding: 24px;
  }

  .form-group {
    margin-bottom: 20px;
  }

  label {
    display: block;
    font-weight: 500;
    margin-bottom: 8px;
    color: #374151;
  }

  .required {
    color: #ef4444;
  }

  input,
  select {
    width: 100%;
    padding: 10px 12px;
    border: 1px solid #d1d5db;
    border-radius: 6px;
    font-size: 14px;
    transition: border-color 0.2s;
  }

  input:focus,
  select:focus {
    outline: none;
    border-color: #2563eb;
    box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
  }

  .error {
    border-color: #ef4444 !important;
  }

  .error-message {
    color: #ef4444;
    font-size: 12px;
    margin-top: 4px;
  }

  .help-text {
    color: #6b7280;
    font-size: 12px;
    margin-top: 4px;
  }

  .balance-info {
    background-color: #f0f9ff;
    border: 1px solid #bae6fd;
    border-radius: 8px;
    padding: 16px;
    margin: 16px 0;
  }

  .balance-info h3 {
    color: #0369a1;
    font-size: 14px;
    margin-bottom: 8px;
  }

  .balance-amount {
    font-size: 20px;
    font-weight: 700;
    color: #059669;
  }

  .balance-amount.negative {
    color: #dc2626;
  }

  .btn {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 12px 24px;
    border-radius: 6px;
    font-size: 14px;
    font-weight: 500;
    text-decoration: none;
    border: none;
    cursor: pointer;
    transition: all 0.2s;
  }

  .btn-primary {
    background-color: #2563eb;
    color: white;
  }

  .btn-primary:hover {
    background-color: #1d4ed8;
  }

  .btn-success {
    background-color: #059669;
    color: white;
  }

  .btn-success:hover {
    background-color: #047857;
  }

  .btn-outline {
    border: 1px solid #d1d5db;
    background: white;
    color: #374151;
  }

  .btn-outline:hover {
    background-color: #f9fafb;
  }

  .form-actions {
    display: flex;
    justify-content: flex-end;
    gap: 16px;
    margin-top: 32px;
  }

  .alert {
    display: none;
    padding: 16px;
    border-radius: 8px;
    margin-bottom: 24px;
  }

  .alert.show {
    display: block;
  }

  .alert-success {
    background-color: #f0fdf4;
    color: #15803d;
    border: 1px solid #22c55e;
  }

  .alert-error {
    background-color: #fef2f2;
    color: #dc2626;
    border: 1px solid #ef4444;
  }

  .tab-content {
    display: none;
  }

  .tab-content.active {
    display: block;
  }

  @media (max-width: 768px) {
    .container {
      padding: 16px;
    }

    .form-actions {
      flex-direction: column;
    }
  }
</style>

<div class="container">
  <div class="page-inner">
  
     <!-- Welcome Section -->
    <section class="welcome-section">
      <h2>Transactions</h2>
      <p>Effectuer des dépôts et retraits sur les comptes clients</p>
    </section>

    <div class="tabs">
      <button class="tab active" onclick="switchTab('deposit')">
        <svg
          width="16"
          height="16"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M12 4v16m8-8H4"
          ></path>
        </svg>
        Dépôt
      </button>
      <button class="tab" onclick="switchTab('withdraw')">
        <svg
          width="16"
          height="16"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M20 12H4"
          ></path>
        </svg>
        Retrait
      </button>
    </div>

    <div id="alert" class="alert">
      <span id="alertMessage"></span>
    </div>

    <div class="card">
      <!-- Onglet Dépôt -->
      <div id="depositTab" class="tab-content active">
        <h2 style="margin-bottom: 24px">Effectuer un dépôt</h2>
        <form id="depositForm">
          <div class="form-group">
            <label for="depositAccount"
              >Compte <span class="required">*</span></label
            >
            <select id="depositAccount" name="account" required>
              <option value="">Sélectionner un compte</option>
              <option value="ACC1234567890">
                ACC1234567890 - Jean Dupont (Courant)
              </option>
              <option value="ACC1234567891">
                ACC1234567891 - Marie Martin (Épargne)
              </option>
              <option value="ACC1234567892">
                ACC1234567892 - Pierre Durand (Courant)
              </option>
            </select>
          </div>

          <div
            id="depositBalanceInfo"
            class="balance-info"
            style="display: none"
          >
            <h3>Solde actuel</h3>
            <div id="depositCurrentBalance" class="balance-amount">0,00 €</div>
          </div>

          <div class="form-group">
            <label for="depositAmount"
              >Montant (€) <span class="required">*</span></label
            >
            <input
              type="number"
              id="depositAmount"
              name="amount"
              step="0.01"
              min="0.01"
              placeholder="100.00"
              required
            />
            <div class="error-message" id="depositAmountError"></div>
          </div>

          <div class="form-group">
            <label for="depositDescription">Description</label>
            <input
              type="text"
              id="depositDescription"
              name="description"
              placeholder="ex: Versement espèces, Virement..."
            />
          </div>

          <div class="form-actions">
            <a href="/accounts" class="btn btn-outline">Annuler</a>
            <button type="submit" class="btn btn-success">
              <svg
                width="16"
                height="16"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 4v16m8-8H4"
                ></path>
              </svg>
              Effectuer le dépôt
            </button>
          </div>
        </form>
      </div>

      <!-- Onglet Retrait -->
      <div id="withdrawTab" class="tab-content">
        <h2 style="margin-bottom: 24px">Effectuer un retrait</h2>
        <form id="withdrawForm">
          <div class="form-group">
            <label for="withdrawAccount"
              >Compte <span class="required">*</span></label
            >
            <select id="withdrawAccount" name="account" required>
              <option value="">Sélectionner un compte</option>
              <option value="ACC1234567890">
                ACC1234567890 - Jean Dupont (Courant)
              </option>
              <option value="ACC1234567891">
                ACC1234567891 - Marie Martin (Épargne)
              </option>
              <option value="ACC1234567892">
                ACC1234567892 - Pierre Durand (Courant)
              </option>
            </select>
          </div>

          <div
            id="withdrawBalanceInfo"
            class="balance-info"
            style="display: none"
          >
            <h3>Solde actuel</h3>
            <div id="withdrawCurrentBalance" class="balance-amount">0,00 €</div>
          </div>

          <div class="form-group">
            <label for="withdrawAmount"
              >Montant (€) <span class="required">*</span></label
            >
            <input
              type="number"
              id="withdrawAmount"
              name="amount"
              step="0.01"
              min="0.01"
              placeholder="50.00"
              required
            />
            <div class="error-message" id="withdrawAmountError"></div>
            <div class="help-text">
              Le retrait ne peut pas dépasser le solde disponible
            </div>
          </div>

          <div class="form-group">
            <label for="withdrawDescription">Description</label>
            <input
              type="text"
              id="withdrawDescription"
              name="description"
              placeholder="ex: Retrait espèces, Virement..."
            />
          </div>

          <div class="form-actions">
            <a href="/accounts" class="btn btn-outline">Annuler</a>
            <button type="submit" class="btn btn-primary">
              <svg
                width="16"
                height="16"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M20 12H4"
                ></path>
              </svg>
              Effectuer le retrait
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<script>
  // Données des comptes
  const accounts = {
    ACC1234567890: { balance: 15247.5, client: "Jean Dupont" },
    ACC1234567891: { balance: 8956.25, client: "Marie Martin" },
    ACC1234567892: { balance: -150.0, client: "Pierre Durand" },
  };

  function switchTab(tabName) {
    // Masquer tous les onglets
    document.querySelectorAll(".tab-content").forEach((tab) => {
      tab.classList.remove("active");
    });
    document.querySelectorAll(".tab").forEach((tab) => {
      tab.classList.remove("active");
    });

    // Afficher l'onglet sélectionné
    document.getElementById(tabName + "Tab").classList.add("active");
    event.target.classList.add("active");
  }

  function formatCurrency(amount) {
    return new Intl.NumberFormat("fr-FR", {
      style: "currency",
      currency: "EUR",
    }).format(amount);
  }

  function showAlert(message, type = "success") {
    const alert = document.getElementById("alert");
    const alertMessage = document.getElementById("alertMessage");

    alert.className = `alert alert-${type} show`;
    alertMessage.textContent = message;

    setTimeout(() => {
      alert.classList.remove("show");
    }, 5000);
  }

  function updateBalance(selectId, balanceInfoId, balanceAmountId) {
    const select = document.getElementById(selectId);
    const balanceInfo = document.getElementById(balanceInfoId);
    const balanceAmount = document.getElementById(balanceAmountId);

    if (select.value && accounts[select.value]) {
      const account = accounts[select.value];
      balanceInfo.style.display = "block";
      balanceAmount.textContent = formatCurrency(account.balance);
      balanceAmount.className =
        account.balance < 0 ? "balance-amount negative" : "balance-amount";
    } else {
      balanceInfo.style.display = "none";
    }
  }

  // Event listeners pour les comptes
  document
    .getElementById("depositAccount")
    .addEventListener("change", function () {
      updateBalance(
        "depositAccount",
        "depositBalanceInfo",
        "depositCurrentBalance"
      );
    });

  document
    .getElementById("withdrawAccount")
    .addEventListener("change", function () {
      updateBalance(
        "withdrawAccount",
        "withdrawBalanceInfo",
        "withdrawCurrentBalance"
      );
    });

  // Formulaire de dépôt
  document
    .getElementById("depositForm")
    .addEventListener("submit", function (e) {
      e.preventDefault();

      const formData = new FormData(this);
      const accountId = formData.get("account");
      const amount = parseFloat(formData.get("amount"));
      const description = formData.get("description");

      if (!accountId || !amount || amount <= 0) {
        showAlert("Veuillez remplir tous les champs obligatoires", "error");
        return;
      }

      // Simulation de transaction
      if (accounts[accountId]) {
        accounts[accountId].balance += amount;

        console.log("Dépôt effectué:", {
          account: accountId,
          amount,
          description,
          newBalance: accounts[accountId].balance,
        });

        showAlert(
          `Dépôt de ${formatCurrency(
            amount
          )} effectué avec succès sur le compte ${accountId}`
        );
        this.reset();
        document.getElementById("depositBalanceInfo").style.display = "none";
      }
    });

  // Formulaire de retrait
  document
    .getElementById("withdrawForm")
    .addEventListener("submit", function (e) {
      e.preventDefault();

      const formData = new FormData(this);
      const accountId = formData.get("account");
      const amount = parseFloat(formData.get("amount"));
      const description = formData.get("description");

      if (!accountId || !amount || amount <= 0) {
        showAlert("Veuillez remplir tous les champs obligatoires", "error");
        return;
      }

      if (accounts[accountId]) {
        if (accounts[accountId].balance < amount) {
          showAlert("Solde insuffisant pour effectuer ce retrait", "error");
          return;
        }

        accounts[accountId].balance -= amount;

        console.log("Retrait effectué:", {
          account: accountId,
          amount,
          description,
          newBalance: accounts[accountId].balance,
        });

        showAlert(
          `Retrait de ${formatCurrency(
            amount
          )} effectué avec succès sur le compte ${accountId}`
        );
        this.reset();
        document.getElementById("withdrawBalanceInfo").style.display = "none";
      }
    });
</script>
{%endblock%}
